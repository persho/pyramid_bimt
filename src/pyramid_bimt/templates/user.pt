<metal:block use-macro="main_template">

  <div metal:fill-slot="content" id="content">

    <a href="${request.route_path('user_list')}">Back to Users overview</a>
    <h1>${user.email}</h1>
    <table class="table">
      <tr><th>Full Name</th><td>${user.fullname}</td><th>
      <tr><th>Email</th><td>${user.email}</td><th>
      <tr><th>Billing Email</th><td>${user.billing_email}</td><th>
      <tr><th>Subscription Valid To</th><td>${user.valid_to}</td><th>
      <tr><th>Affiliate</th><td>${user.affiliate}</td><th>
      <tr><th>Created</th><td>${user.created.strftime('%Y/%m/%d %H:%M:%S')}</td><th>
      <tr><th>Modified</th><td>${user.modified.strftime('%Y/%m/%d %H:%M:%S')}</td><th>
      <tr><th>Groups</th><td>${', '.join([g.name for g in user.groups])}</td><th>
      <tr>
        <th>Audit Log</th>
        <td>
          <table class="table table-condensed">
            <tr>
              <th>Timestamp</th>
              <th>Event Type</th>
              <th>Comment</th>
            </tr>
            <tr tal:repeat="entry audit_log_entries">
              <td>${entry.timestamp.strftime('%Y/%m/%d %H:%M:%S')}</td>
              <td>${entry.event_type.title}</td>
              <td>${entry.comment}</td>
            </tr>
          </table>
        </td>
      <th>
    </table>


    <h2>User Properties</h2>
    <table class="table">
      <tr tal:repeat="property properties">
        <th>${property.key}</th><td>${property.value}</td>
      </tr>
    </table>

  </div/>

</metal:block>
