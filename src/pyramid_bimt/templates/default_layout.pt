<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>${layout.current_page} - ${layout.app_title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="${layout.app_title}">
    <meta name="author" content="NiteoWeb Ltd.">

    <tal:sentry condition="layout.sentry_dsn">
      ${panel('raven-js')}
    </tal:sentry>

    <!-- Le styles -->
    <link rel="stylesheet"
          href="${request.static_url('deform:static/css/form.css')}"
          type="text/css"/>
    <link rel="stylesheet"
          href="${request.static_url('deform:static/css/bootstrap.min.css')}"
          type="text/css" media="screen" charset="utf-8"/>
    <tal:block metal:define-slot="css" />

    <!-- TODO: Placed at the end of the document so the pages load faster -->
    <script src="${request.static_url('deform:static/scripts/jquery-2.0.3.min.js')}" type="text/javascript"></script>
    <script src="${request.static_url('deform:static/scripts/bootstrap.min.js')}" type="text/javascript"></script>
    <tal:block metal:define-slot="js" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Favicon -->
    <tal:block metal:define-slot="favicon" />
  </head>

  <body tal:attributes="class econtext.view.__name__ | econtext.view.__class__.__name__">

    ${panel('navbar')}

    <div class="container-fluid">
      <div class="row-fluid">

        <div id="flash" tal:condition="request.session.peek_flash()">
          <div class="alert alert-info" tal:repeat="message request.session.pop_flash()">
                ${message}
          </div>
        </div>

        <div id="flash" tal:condition="request.session.peek_flash('info')">
          <div class="alert alert-info" tal:repeat="message request.session.pop_flash('info')">
                ${message}
          </div>
        </div>

        <div id="flash" tal:condition="request.session.peek_flash('warning')">
          <div class="alert alert-warning" tal:repeat="message request.session.pop_flash('warning')">
                ${message}
          </div>
        </div>

        <div id="flash" tal:condition="request.session.peek_flash('error')">
          <div class="alert alert-danger" tal:repeat="message request.session.pop_flash('error')">
                ${message}
          </div>
        </div>

        <div class="col-md-3" tal:condition="request.user and request.user.enabled and not layout.hide_sidebar">
          ${panel('sidebar')}
        </div>

        <div class="${python: 'col-md-12' if layout.hide_sidebar else 'col-md-9'}">
          <div metal:define-slot="content" id="content" />
        </div>

      </div> <!--/.row-fluid-->
      <div class="row-fluid">
        <div class="col-md-11">
          <hr />
          <footer>
            ${panel('footer')}
          </footer>
        </div>
      </div> <!--/.row-fluid-->
    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <div tal:define="piwik_site_id request.registry.settings.get('bimt.piwik_site_id')"
         tal:condition="piwik_site_id">
      <!-- Piwik -->
      <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(["trackPageView"]);
        _paq.push(["enableLinkTracking"]);

        (function() {
          var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.niteoweb.com/";
          _paq.push(["setTrackerUrl", u+"piwik.php"]);
          _paq.push(["setSiteId", "${piwik_site_id}"]);
          var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
          g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
        })();
      </script>
      <!-- End Piwik Code -->
    </div>

  </body>
</html>